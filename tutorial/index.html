<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Urwid Tutorial &#8212; Urwid 2.6.10</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=1f4f2616" />
    
    <script src="../_static/documentation_options.js?v=235c4503"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="canonical" href="https://urwid.org/tutorial/index.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Urwid Manual" href="../manual/index.html" />
    <link rel="prev" title="Example Programs" href="../examples/index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../manual/index.html" title="Urwid Manual"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../examples/index.html" title="Example Programs"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Urwid 2.6.10</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Urwid Tutorial</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="urwid-tutorial">
<span id="id1"></span><h1>Urwid Tutorial<a class="headerlink" href="#urwid-tutorial" title="Link to this heading">¶</a></h1>
<section id="minimal-application">
<h2>Minimal Application<a class="headerlink" href="#minimal-application" title="Link to this heading">¶</a></h2>
<img alt="../_images/minimal1.png" src="../_images/minimal1.png" />
<p>This program displays the string <code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World</span></code> in the top left corner of the
screen and will run until interrupted with <em>CTRL+C</em> (<em>^C</em>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="n">txt</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>
<span class="linenos">6</span><span class="n">fill</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">)</span>
<span class="linenos">7</span><span class="n">loop</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
<span class="linenos">8</span><span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <em>txt</em> <a class="reference internal" href="../reference/widget.html#urwid.Text" title="urwid.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">Text</span></code></a> widget handles formatting blocks of text,
wrapping to the next line when necessary. Widgets like this are called “flow
widgets” because their sizing can have a number of columns given, in this
case the full screen width, then they will flow to fill as many rows as
necessary.</p></li>
<li><p>The <em>fill</em> <a class="reference internal" href="../reference/widget.html#urwid.Filler" title="urwid.Filler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Filler</span></code></a> widget fills in blank lines above or
below flow widgets so that they can be displayed in a fixed number of rows.
This Filler will align our Text to the top of the screen, filling all the
rows below with blank lines. Widgets which are given both the number of
columns and number of rows they must be displayed in are called “box
widgets”.</p></li>
<li><p>The <a class="reference internal" href="../reference/main_loop.html#urwid.MainLoop" title="urwid.MainLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">MainLoop</span></code></a> class handles displaying our widgets as
well as accepting input from the user.
The widget passed to <a class="reference internal" href="../reference/main_loop.html#urwid.MainLoop" title="urwid.MainLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">MainLoop</span></code></a> is called the “topmost” widget.
The topmost widget is used to render the whole screen and so it must be a box widget.
In this case our widgets can’t handle any user input so we need to interrupt
the program to exit with <em>^C</em>.</p></li>
</ul>
</section>
<section id="global-input">
<h2>Global Input<a class="headerlink" href="#global-input" title="Link to this heading">¶</a></h2>
<img alt="../_images/input1.png" src="../_images/input1.png" />
<img alt="../_images/input2.png" src="../_images/input2.png" />
<img alt="../_images/input3.png" src="../_images/input3.png" />
<img alt="../_images/input4.png" src="../_images/input4.png" />
<img alt="../_images/input5.png" src="../_images/input5.png" />
<p>This program initially displays the string <code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World</span></code>, then it displays
each key pressed, exiting when the user presses <em>Q</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="k">def</span> <span class="nf">show_or_exit</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 7</span>    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">}:</span>
<span class="linenos"> 8</span>        <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos"> 9</span>    <span class="n">txt</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
<span class="linenos">10</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">txt</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>
<span class="linenos">13</span><span class="n">fill</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">)</span>
<span class="linenos">14</span><span class="n">loop</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">fill</span><span class="p">,</span> <span class="n">unhandled_input</span><span class="o">=</span><span class="n">show_or_exit</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <a class="reference internal" href="../reference/main_loop.html#urwid.MainLoop" title="urwid.MainLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">MainLoop</span></code></a> class has an optional function
parameter <em>unhandled_input</em>. This function will be called once for each
keypress that is not handled by the widgets being displayed.
Since none of the widgets being displayed here handle input, every key the user
presses will be passed to the <em>show_or_exit</em> function.</p></li>
<li><p>The <a class="reference internal" href="../reference/exceptions.html#urwid.ExitMainLoop" title="urwid.ExitMainLoop"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ExitMainLoop</span></code></a> exception is used to exit
cleanly from the <a class="reference internal" href="../reference/main_loop.html#urwid.MainLoop.run" title="urwid.MainLoop.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MainLoop.run()</span></code></a> function when the user
presses <em>Q</em>. All other input is displayed by replacing the current Text
widget’s content.</p></li>
</ul>
</section>
<section id="display-attributes">
<h2>Display Attributes<a class="headerlink" href="#display-attributes" title="Link to this heading">¶</a></h2>
<img alt="../_images/urwid_attr1.png" src="../_images/urwid_attr1.png" />
<img alt="../_images/urwid_attr2.png" src="../_images/urwid_attr2.png" />
<img alt="../_images/urwid_attr3.png" src="../_images/urwid_attr3.png" />
<img alt="../_images/urwid_attr4.png" src="../_images/urwid_attr4.png" />
<p>This program displays the string <code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World</span></code> in the center of the screen.
It uses different attributes for the text, the space on either side of the text
and the space above and below the text. It waits for a keypress before exiting.</p>
<p>The screenshots above show how these widgets react to being resized.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="k">def</span> <span class="nf">exit_on_q</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 7</span>    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">}:</span>
<span class="linenos"> 8</span>        <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="n">palette</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">12</span>    <span class="p">(</span><span class="s2">&quot;banner&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;light gray&quot;</span><span class="p">),</span>
<span class="linenos">13</span>    <span class="p">(</span><span class="s2">&quot;streak&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;dark red&quot;</span><span class="p">),</span>
<span class="linenos">14</span>    <span class="p">(</span><span class="s2">&quot;bg&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;dark blue&quot;</span><span class="p">),</span>
<span class="linenos">15</span><span class="p">]</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="n">txt</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">((</span><span class="s2">&quot;banner&quot;</span><span class="p">,</span> <span class="s2">&quot; Hello World &quot;</span><span class="p">),</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="linenos">18</span><span class="n">map1</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="s2">&quot;streak&quot;</span><span class="p">)</span>
<span class="linenos">19</span><span class="n">fill</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">(</span><span class="n">map1</span><span class="p">)</span>
<span class="linenos">20</span><span class="n">map2</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">fill</span><span class="p">,</span> <span class="s2">&quot;bg&quot;</span><span class="p">)</span>
<span class="linenos">21</span><span class="n">loop</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">map2</span><span class="p">,</span> <span class="n">palette</span><span class="p">,</span> <span class="n">unhandled_input</span><span class="o">=</span><span class="n">exit_on_q</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<ul>
<li><p>Display attributes are defined as part of a palette. Valid foreground,
background and
setting values are documented in <a class="reference internal" href="../manual/displayattributes.html#foreground-background"><span class="std std-ref">Foreground and Background Settings</span></a>
A palette is a list of tuples containing:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Name of the display attribute, typically a string</p></li>
<li><p>Foreground color and settings for 16-color (normal) mode</p></li>
<li><p>Background color for normal mode</p></li>
<li><p>Settings for monochrome mode (optional)</p></li>
<li><p>Foreground color and settings for 88 and 256-color modes (optional, see
next example)</p></li>
<li><p>Background color for 88 and 256-color modes (optional)</p></li>
</ol>
</div></blockquote>
</li>
<li><p>A <a class="reference internal" href="../reference/widget.html#urwid.Text" title="urwid.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">Text</span></code></a> widget is created containing the string <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">Hello</span> <span class="pre">World</span> <span class="pre">&quot;</span></code>
with display attribute <code class="docutils literal notranslate"><span class="pre">'banner'</span></code>. The attributes of text in a Text widget is
set by using a (<em>attribute</em>, <em>text</em>) tuple instead of a simple text string.
Display attributes will flow with the text, and multiple display attributes may be
specified by combining tuples into a list. This format is called <a class="reference internal" href="../manual/displayattributes.html#text-markup"><span class="std std-ref">Text Markup</span></a>.</p></li>
<li><p>An <a class="reference internal" href="../reference/widget.html#urwid.AttrMap" title="urwid.AttrMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrMap</span></code></a> widget is created to wrap the text
widget with display attribute <code class="docutils literal notranslate"><span class="pre">'streak'</span></code>. <a class="reference internal" href="../reference/widget.html#urwid.AttrMap" title="urwid.AttrMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrMap</span></code></a> widgets
allow you to map any display attribute to any other display attribute, but by default they
will set the display attribute of everything that does not already have a display attribute.
In this case the text has an attribute, so only the areas around the text
used for alignment will have the new attribute.</p></li>
<li><p>A second <a class="reference internal" href="../reference/widget.html#urwid.AttrMap" title="urwid.AttrMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrMap</span></code></a> widget is created to wrap the
<a class="reference internal" href="../reference/widget.html#urwid.Filler" title="urwid.Filler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Filler</span></code></a> widget with attribute <code class="docutils literal notranslate"><span class="pre">'bg'</span></code>.</p></li>
</ul>
<p>When this program is run you can now clearly see the separation of the text,
the alignment around the text, and the filler above and below the text.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../manual/displayattributes.html#using-display-attributes"><span class="std std-ref">Using Display Attributes</span></a></p>
</div>
</section>
<section id="high-color-modes">
<h2>High Color Modes<a class="headerlink" href="#high-color-modes" title="Link to this heading">¶</a></h2>
<img alt="../_images/highcolors1.png" src="../_images/highcolors1.png" />
<p>This program displays the string <code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World</span></code> in the center of the screen.
It uses a number of 256-color-mode colors to decorate the text,
and will work in any terminal that supports 256-color mode. It will exit when
<em>Q</em> is pressed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="k">def</span> <span class="nf">exit_on_q</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="linenos"> 7</span>    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">}:</span>
<span class="linenos"> 8</span>        <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="n">palette</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">12</span>    <span class="p">(</span><span class="s2">&quot;banner&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;#ffa&quot;</span><span class="p">,</span> <span class="s2">&quot;#60d&quot;</span><span class="p">),</span>
<span class="linenos">13</span>    <span class="p">(</span><span class="s2">&quot;streak&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;g50&quot;</span><span class="p">,</span> <span class="s2">&quot;#60a&quot;</span><span class="p">),</span>
<span class="linenos">14</span>    <span class="p">(</span><span class="s2">&quot;inside&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;g38&quot;</span><span class="p">,</span> <span class="s2">&quot;#808&quot;</span><span class="p">),</span>
<span class="linenos">15</span>    <span class="p">(</span><span class="s2">&quot;outside&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;g27&quot;</span><span class="p">,</span> <span class="s2">&quot;#a06&quot;</span><span class="p">),</span>
<span class="linenos">16</span>    <span class="p">(</span><span class="s2">&quot;bg&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;g7&quot;</span><span class="p">,</span> <span class="s2">&quot;#d06&quot;</span><span class="p">),</span>
<span class="linenos">17</span><span class="p">]</span>
<span class="linenos">18</span>
<span class="linenos">19</span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">SolidFill</span><span class="p">()</span>
<span class="linenos">20</span><span class="n">loop</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">placeholder</span><span class="p">,</span> <span class="n">palette</span><span class="p">,</span> <span class="n">unhandled_input</span><span class="o">=</span><span class="n">exit_on_q</span><span class="p">)</span>
<span class="linenos">21</span><span class="n">loop</span><span class="o">.</span><span class="n">screen</span><span class="o">.</span><span class="n">set_terminal_properties</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">loop</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">placeholder</span><span class="p">,</span> <span class="s2">&quot;bg&quot;</span><span class="p">)</span>
<span class="linenos">23</span><span class="n">loop</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">original_widget</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Pile</span><span class="p">([]))</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="n">div</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Divider</span><span class="p">()</span>
<span class="linenos">26</span><span class="n">outside</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">div</span><span class="p">,</span> <span class="s2">&quot;outside&quot;</span><span class="p">)</span>
<span class="linenos">27</span><span class="n">inside</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">div</span><span class="p">,</span> <span class="s2">&quot;inside&quot;</span><span class="p">)</span>
<span class="linenos">28</span><span class="n">txt</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">((</span><span class="s2">&quot;banner&quot;</span><span class="p">,</span> <span class="s2">&quot; Hello World &quot;</span><span class="p">),</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="linenos">29</span><span class="n">streak</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="s2">&quot;streak&quot;</span><span class="p">)</span>
<span class="linenos">30</span><span class="n">pile</span> <span class="o">=</span> <span class="n">loop</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">base_widget</span>  <span class="c1"># .base_widget skips the decorations</span>
<span class="linenos">31</span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="p">(</span><span class="n">outside</span><span class="p">,</span> <span class="n">inside</span><span class="p">,</span> <span class="n">streak</span><span class="p">,</span> <span class="n">inside</span><span class="p">,</span> <span class="n">outside</span><span class="p">):</span>
<span class="linenos">32</span>    <span class="n">pile</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">item</span><span class="p">,</span> <span class="n">pile</span><span class="o">.</span><span class="n">options</span><span class="p">()))</span>
<span class="linenos">33</span>
<span class="linenos">34</span><span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>This palette only defines values for the high color foreground and
backgrounds, because only the high colors will be used. A real application
should define values for all the modes in their palette. Valid foreground,
background and setting values are documented in <a class="reference internal" href="../manual/displayattributes.html#foreground-background"><span class="std std-ref">Foreground and Background Settings</span></a>.</p>
<ul class="simple">
<li><p>Behind the scenes our <a class="reference internal" href="../reference/main_loop.html#urwid.MainLoop" title="urwid.MainLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">MainLoop</span></code></a> class has created a
<code class="xref py py-class docutils literal notranslate"><span class="pre">raw_display.Screen</span></code> object for drawing the screen. The program
is put into 256-color mode by using the screen object’s
<code class="xref py py-meth docutils literal notranslate"><span class="pre">set_terminal_properties()</span></code> method.</p></li>
</ul>
<p>This example also demonstrates how you can build the widgets to display
in a top-down order instead of the usual bottom-up order. In some
places we need to use a <em>placeholder</em> widget because we must provide
a widget before the correct one has been created.</p>
<ul class="simple">
<li><p>We change the topmost widget used by the <a class="reference internal" href="../reference/main_loop.html#urwid.MainLoop" title="urwid.MainLoop"><code class="xref py py-class docutils literal notranslate"><span class="pre">MainLoop</span></code></a> by
assigning to its <a class="reference internal" href="../reference/main_loop.html#urwid.MainLoop.widget" title="urwid.MainLoop.widget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">MainLoop.widget</span></code></a> property.</p></li>
<li><p><a class="reference internal" href="../manual/widgets.html#decoration-widgets"><span class="std std-ref">Decoration Widgets</span></a> like <a class="reference internal" href="../reference/widget.html#urwid.AttrMap" title="urwid.AttrMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrMap</span></code></a> have an
<code class="docutils literal notranslate"><span class="pre">original_widget</span></code> property that we can assign to change the widget they wrap.</p></li>
<li><p><a class="reference internal" href="../reference/widget.html#urwid.Divider" title="urwid.Divider"><code class="xref py py-class docutils literal notranslate"><span class="pre">Divider</span></code></a> widgets are used to create blank lines,
colored with <a class="reference internal" href="../reference/widget.html#urwid.AttrMap" title="urwid.AttrMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrMap</span></code></a>.</p></li>
<li><p><a class="reference internal" href="../manual/widgets.html#container-widgets"><span class="std std-ref">Container Widgets</span></a> like <a class="reference internal" href="../reference/widget.html#urwid.Pile" title="urwid.Pile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pile</span></code></a> have a
<code class="docutils literal notranslate"><span class="pre">contents</span></code> property that we can treat like a list of
(<em>widget</em>, <em>options</em>) tuples.  <a class="reference internal" href="../reference/widget.html#urwid.Pile.contents" title="urwid.Pile.contents"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pile.contents</span></code></a> supports normal list
operations including <code class="docutils literal notranslate"><span class="pre">append()</span></code> to add child widgets.
<a class="reference internal" href="../reference/widget.html#urwid.Pile.options" title="urwid.Pile.options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pile.options()</span></code></a> is used to generate the default options
for the new child widgets.</p></li>
</ul>
</section>
<section id="question-and-answer">
<h2>Question and Answer<a class="headerlink" href="#question-and-answer" title="Link to this heading">¶</a></h2>
<img alt="../_images/qa1.png" src="../_images/qa1.png" />
<img alt="../_images/qa2.png" src="../_images/qa2.png" />
<img alt="../_images/qa3.png" src="../_images/qa3.png" />
<p>This program asks for your name then responds <code class="docutils literal notranslate"><span class="pre">Nice</span> <span class="pre">to</span> <span class="pre">meet</span> <span class="pre">you,</span> <span class="pre">(your</span>
<span class="pre">name).</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="k">def</span> <span class="nf">exit_on_q</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 7</span>    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="s2">&quot;Q&quot;</span><span class="p">}:</span>
<span class="linenos"> 8</span>        <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="k">class</span> <span class="nc">QuestionBox</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">):</span>
<span class="linenos">12</span>    <span class="k">def</span> <span class="nf">keypress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">13</span>        <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;enter&quot;</span><span class="p">:</span>
<span class="linenos">14</span>            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">keypress</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="linenos">15</span>        <span class="bp">self</span><span class="o">.</span><span class="n">original_widget</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span>
<span class="linenos">16</span>            <span class="sa">f</span><span class="s2">&quot;Nice to meet you,</span><span class="se">\n</span><span class="si">{</span><span class="n">edit</span><span class="o">.</span><span class="n">edit_text</span><span class="si">}</span><span class="s2">.</span><span class="se">\n\n</span><span class="s2">Press Q to exit.&quot;</span><span class="p">,</span>
<span class="linenos">17</span>        <span class="p">)</span>
<span class="linenos">18</span>        <span class="k">return</span> <span class="kc">None</span>
<span class="linenos">19</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="n">edit</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Edit</span><span class="p">(</span><span class="s2">&quot;What is your name?</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">fill</span> <span class="o">=</span> <span class="n">QuestionBox</span><span class="p">(</span><span class="n">edit</span><span class="p">)</span>
<span class="linenos">23</span><span class="n">loop</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">fill</span><span class="p">,</span> <span class="n">unhandled_input</span><span class="o">=</span><span class="n">exit_on_q</span><span class="p">)</span>
<span class="linenos">24</span><span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../reference/widget.html#urwid.Edit" title="urwid.Edit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edit</span></code></a> widget is based on the <a class="reference internal" href="../reference/widget.html#urwid.Text" title="urwid.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">Text</span></code></a> widget but it accepts
keyboard input for entering text, making corrections and
moving the cursor around with the <em>HOME</em>, <em>END</em> and arrow keys.</p>
<p>Here we are customizing the <a class="reference internal" href="../reference/widget.html#urwid.Filler" title="urwid.Filler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Filler</span></code></a> decoration widget that is holding
our <a class="reference internal" href="../reference/widget.html#urwid.Edit" title="urwid.Edit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edit</span></code></a> widget by subclassing it and defining a new <code class="docutils literal notranslate"><span class="pre">keypress()</span></code>
method.  Customizing decoration or container widgets to handle input this way
is a common pattern in Urwid applications.  This pattern is easier to maintain
and extend than handling all special input in an <em>unhandled_input</em> function.</p>
<ul class="simple">
<li><p>In <em>QuestionBox.keypress()</em> all keypresses except <em>ENTER</em> are passed along to
the default <a class="reference internal" href="../reference/widget.html#urwid.Filler.keypress" title="urwid.Filler.keypress"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Filler.keypress()</span></code></a> which sends them to the
child <a class="reference internal" href="../reference/widget.html#urwid.Edit.keypress" title="urwid.Edit.keypress"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Edit.keypress()</span></code></a> method.</p></li>
<li><p>Note that names containing <em>Q</em> can be entered into the <a class="reference internal" href="../reference/widget.html#urwid.Edit" title="urwid.Edit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edit</span></code></a>
widget without causing the program to exit because <a class="reference internal" href="../reference/widget.html#urwid.Edit.keypress" title="urwid.Edit.keypress"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Edit.keypress()</span></code></a>
indicates that it has handled the key by returning <code class="docutils literal notranslate"><span class="pre">None</span></code>.
See <a class="reference internal" href="../reference/widget.html#urwid.Widget.keypress" title="urwid.Widget.keypress"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Widget.keypress()</span></code></a> for more information.</p></li>
<li><p>When <em>ENTER</em> is pressed the child widget <code class="docutils literal notranslate"><span class="pre">original_widget</span></code> is changed
to a <a class="reference internal" href="../reference/widget.html#urwid.Text" title="urwid.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">Text</span></code></a> widget.</p></li>
<li><p><a class="reference internal" href="../reference/widget.html#urwid.Text" title="urwid.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">Text</span></code></a> widgets don’t handle any keyboard input so all input
ends up in the <em>unhandled_input</em> function <em>exit_on_q</em>, allowing the
user to exit the program.</p></li>
</ul>
</section>
<section id="signal-handlers">
<h2>Signal Handlers<a class="headerlink" href="#signal-handlers" title="Link to this heading">¶</a></h2>
<img alt="../_images/sig1.png" src="../_images/sig1.png" />
<img alt="../_images/sig2.png" src="../_images/sig2.png" />
<img alt="../_images/sig3.png" src="../_images/sig3.png" />
<img alt="../_images/sig4.png" src="../_images/sig4.png" />
<p>This program asks for your name and responds <code class="docutils literal notranslate"><span class="pre">Nice</span> <span class="pre">to</span> <span class="pre">meet</span> <span class="pre">you,</span> <span class="pre">(your</span> <span class="pre">name)</span></code>
<em>while</em> you type your name.  Press <em>DOWN</em> then <em>SPACE</em> or <em>ENTER</em> to exit.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">typing</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="n">palette</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;I say&quot;</span><span class="p">,</span> <span class="s2">&quot;default,bold&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="s2">&quot;bold&quot;</span><span class="p">)]</span>
<span class="linenos"> 8</span><span class="n">ask</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Edit</span><span class="p">((</span><span class="s2">&quot;I say&quot;</span><span class="p">,</span> <span class="s2">&quot;What is your name?</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="linenos"> 9</span><span class="n">reply</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="linenos">10</span><span class="n">button_inst</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s2">&quot;Exit&quot;</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">div</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Divider</span><span class="p">()</span>
<span class="linenos">12</span><span class="n">pile</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Pile</span><span class="p">([</span><span class="n">ask</span><span class="p">,</span> <span class="n">div</span><span class="p">,</span> <span class="n">reply</span><span class="p">,</span> <span class="n">div</span><span class="p">,</span> <span class="n">button_inst</span><span class="p">])</span>
<span class="linenos">13</span><span class="n">top</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">(</span><span class="n">pile</span><span class="p">,</span> <span class="n">valign</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
<span class="linenos">14</span>
<span class="linenos">15</span>
<span class="linenos">16</span><span class="k">def</span> <span class="nf">on_ask_change</span><span class="p">(</span><span class="n">_edit</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Edit</span><span class="p">,</span> <span class="n">new_edit_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">17</span>    <span class="n">reply</span><span class="o">.</span><span class="n">set_text</span><span class="p">((</span><span class="s2">&quot;I say&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Nice to meet you, </span><span class="si">{</span><span class="n">new_edit_text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="linenos">18</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="k">def</span> <span class="nf">on_exit_clicked</span><span class="p">(</span><span class="n">_button</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">NoReturn</span><span class="p">:</span>
<span class="linenos">21</span>    <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos">22</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="n">urwid</span><span class="o">.</span><span class="n">connect_signal</span><span class="p">(</span><span class="n">ask</span><span class="p">,</span> <span class="s2">&quot;change&quot;</span><span class="p">,</span> <span class="n">on_ask_change</span><span class="p">)</span>
<span class="linenos">25</span><span class="n">urwid</span><span class="o">.</span><span class="n">connect_signal</span><span class="p">(</span><span class="n">button_inst</span><span class="p">,</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="n">on_exit_clicked</span><span class="p">)</span>
<span class="linenos">26</span>
<span class="linenos">27</span><span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">palette</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>An <a class="reference internal" href="../reference/widget.html#urwid.Edit" title="urwid.Edit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edit</span></code></a> widget and a <a class="reference internal" href="../reference/widget.html#urwid.Text" title="urwid.Text"><code class="xref py py-class docutils literal notranslate"><span class="pre">Text</span></code></a> reply
widget are created, like in the previous example.</p></li>
<li><p>The <a class="reference internal" href="../reference/signals.html#urwid.connect_signal" title="urwid.connect_signal"><code class="xref py py-func docutils literal notranslate"><span class="pre">connect_signal()</span></code></a> function is used to attach our
<em>on_ask_change()</em> function to our <a class="reference internal" href="../reference/widget.html#urwid.Edit" title="urwid.Edit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edit</span></code></a> widget’s
<code class="docutils literal notranslate"><span class="pre">'change'</span></code> signal. Now any time the content of the <a class="reference internal" href="../reference/widget.html#urwid.Edit" title="urwid.Edit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edit</span></code></a>
widget changes <em>on_ask_change()</em> will be called and passed the new
content.</p></li>
<li><p>Finally we attach our <em>on_exit_clicked()</em> function to our
exit <a class="reference internal" href="../reference/widget.html#urwid.Button" title="urwid.Button"><code class="xref py py-class docutils literal notranslate"><span class="pre">Button</span></code></a>’s <code class="docutils literal notranslate"><span class="pre">'click'</span></code> signal.</p></li>
<li><p><em>on_ask_change()</em> updates the reply text as the user enters their
name and <em>on_exit_click()</em> exits.</p></li>
</ul>
</section>
<section id="multiple-questions">
<h2>Multiple Questions<a class="headerlink" href="#multiple-questions" title="Link to this heading">¶</a></h2>
<img alt="../_images/multiple1.png" src="../_images/multiple1.png" />
<img alt="../_images/multiple2.png" src="../_images/multiple2.png" />
<img alt="../_images/multiple3.png" src="../_images/multiple3.png" />
<img alt="../_images/multiple4.png" src="../_images/multiple4.png" />
<p>This program asks for your name and responds <code class="docutils literal notranslate"><span class="pre">Nice</span> <span class="pre">to</span> <span class="pre">meet</span> <span class="pre">you,</span> <span class="pre">(your</span> <span class="pre">name).</span></code>
It then asks again, and again. Old values may be changed and the responses will
be updated when you press <em>ENTER</em>. <em>ENTER</em> on a blank line exits.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="k">def</span> <span class="nf">question</span><span class="p">():</span>
<span class="linenos"> 7</span>    <span class="k">return</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Pile</span><span class="p">([</span><span class="n">urwid</span><span class="o">.</span><span class="n">Edit</span><span class="p">((</span><span class="s2">&quot;I say&quot;</span><span class="p">,</span> <span class="s2">&quot;What is your name?</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))])</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="k">def</span> <span class="nf">answer</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="linenos">11</span>    <span class="k">return</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">((</span><span class="s2">&quot;I say&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Nice to meet you, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="linenos">12</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="k">class</span> <span class="nc">ConversationListBox</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">ListBox</span><span class="p">):</span>
<span class="linenos">15</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">16</span>        <span class="n">body</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">SimpleFocusListWalker</span><span class="p">([</span><span class="n">question</span><span class="p">()])</span>
<span class="linenos">17</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
<span class="linenos">18</span>
<span class="linenos">19</span>    <span class="k">def</span> <span class="nf">keypress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">20</span>        <span class="n">key</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">keypress</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="linenos">21</span>        <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;enter&quot;</span><span class="p">:</span>
<span class="linenos">22</span>            <span class="k">return</span> <span class="n">key</span>
<span class="linenos">23</span>        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">edit_text</span>
<span class="linenos">24</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
<span class="linenos">25</span>            <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos">26</span>        <span class="c1"># replace or add response</span>
<span class="linenos">27</span>        <span class="bp">self</span><span class="o">.</span><span class="n">focus</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">answer</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus</span><span class="o">.</span><span class="n">options</span><span class="p">())]</span>
<span class="linenos">28</span>        <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">focus_position</span>
<span class="linenos">29</span>        <span class="c1"># add a new question</span>
<span class="linenos">30</span>        <span class="bp">self</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">question</span><span class="p">())</span>
<span class="linenos">31</span>        <span class="bp">self</span><span class="o">.</span><span class="n">focus_position</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
<span class="linenos">32</span>        <span class="k">return</span> <span class="kc">None</span>
<span class="linenos">33</span>
<span class="linenos">34</span>
<span class="linenos">35</span><span class="n">palette</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;I say&quot;</span><span class="p">,</span> <span class="s2">&quot;default,bold&quot;</span><span class="p">,</span> <span class="s2">&quot;default&quot;</span><span class="p">)]</span>
<span class="linenos">36</span><span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">ConversationListBox</span><span class="p">(),</span> <span class="n">palette</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p><a class="reference internal" href="../reference/widget.html#urwid.ListBox" title="urwid.ListBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">ListBox</span></code></a> widgets let you scroll through a number of flow widgets
vertically.  It handles <em>UP</em>, <em>DOWN</em>, <em>PAGE UP</em> and <em>PAGE DOWN</em> keystrokes
and changing the focus for you.  <a class="reference internal" href="../manual/widgets.html#listbox-contents"><span class="std std-ref">ListBox Contents</span></a> are managed by
a “list walker”, one of the list walkers that is easiest to use is
<a class="reference internal" href="../reference/list_walkers.html#urwid.SimpleFocusListWalker" title="urwid.SimpleFocusListWalker"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleFocusListWalker</span></code></a>.</p>
<p><a class="reference internal" href="../reference/list_walkers.html#urwid.SimpleFocusListWalker" title="urwid.SimpleFocusListWalker"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleFocusListWalker</span></code></a> is like a normal python list of widgets, but
any time you insert or remove widgets the focus position is updated
automatically.</p>
<p>Here we are customizing our <a class="reference internal" href="../reference/widget.html#urwid.ListBox" title="urwid.ListBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">ListBox</span></code></a>’s keypress handling by overriding
it in a subclass.</p>
<ul class="simple">
<li><p>The <em>question()</em> function is used to build widgets to communicate with the user.
Here we return a <a class="reference internal" href="../reference/widget.html#urwid.Pile" title="urwid.Pile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pile</span></code></a> widget with a single <a class="reference internal" href="../reference/widget.html#urwid.Edit" title="urwid.Edit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Edit</span></code></a> widget
to start.</p></li>
<li><p>We retrieve the name entered with <a class="reference internal" href="../reference/widget.html#urwid.ListBox.focus" title="urwid.ListBox.focus"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ListBox.focus</span></code></a> to get the
<a class="reference internal" href="../reference/widget.html#urwid.Pile" title="urwid.Pile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pile</span></code></a> in focus, the standard
<a class="reference internal" href="../manual/widgets.html#container-widgets"><span class="std std-ref">container widget</span></a> method <code class="docutils literal notranslate"><span class="pre">[0]</span></code> to get the
first child of the pile and <a class="reference internal" href="../reference/widget.html#urwid.Edit.edit_text" title="urwid.Edit.edit_text"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Edit.edit_text</span></code></a> to get the user-entered
text.</p></li>
<li><p>For the response we use the fact that we can treat
<a class="reference internal" href="../reference/widget.html#urwid.Pile.contents" title="urwid.Pile.contents"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pile.contents</span></code></a> like a list of (<em>widget</em>, <em>options</em>) tuples to create or
replace any existing response by assigning a one-tuple list to <em>contents[1:]</em>.  We create
the default options using <a class="reference internal" href="../reference/widget.html#urwid.Pile.options" title="urwid.Pile.options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pile.options()</span></code></a>.</p></li>
<li><p>To add another question after the current one we treat our
<a class="reference internal" href="../reference/list_walkers.html#urwid.SimpleFocusListWalker" title="urwid.SimpleFocusListWalker"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimpleFocusListWalker</span></code></a> stored as <a class="reference internal" href="../reference/widget.html#urwid.ListBox.body" title="urwid.ListBox.body"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ListBox.body</span></code></a> like a normal
list of widgets by calling <em>insert()</em>, then update the focus position to the widget we just
created.</p></li>
</ul>
</section>
<section id="simple-menu">
<h2>Simple Menu<a class="headerlink" href="#simple-menu" title="Link to this heading">¶</a></h2>
<img alt="../_images/smenu1.png" src="../_images/smenu1.png" />
<img alt="../_images/smenu2.png" src="../_images/smenu2.png" />
<img alt="../_images/smenu3.png" src="../_images/smenu3.png" />
<p>We can create a very simple menu using a list of <a class="reference internal" href="../reference/widget.html#urwid.Button" title="urwid.Button"><code class="xref py py-class docutils literal notranslate"><span class="pre">Button</span></code></a> widgets.
This program lets you choose an option then repeats what you chose.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">typing</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos"> 8</span>    <span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Iterable</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="n">choices</span> <span class="o">=</span> <span class="s2">&quot;Chapman Cleese Gilliam Idle Jones Palin&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="linenos">11</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="k">def</span> <span class="nf">menu</span><span class="p">(</span><span class="n">title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">choices_</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ListBox</span><span class="p">:</span>
<span class="linenos">14</span>    <span class="n">body</span> <span class="o">=</span> <span class="p">[</span><span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">title</span><span class="p">),</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Divider</span><span class="p">()]</span>
<span class="linenos">15</span>    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">choices_</span><span class="p">:</span>
<span class="linenos">16</span>        <span class="n">button</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="linenos">17</span>        <span class="n">urwid</span><span class="o">.</span><span class="n">connect_signal</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="n">item_chosen</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="linenos">18</span>        <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">focus_map</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">))</span>
<span class="linenos">19</span>    <span class="k">return</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">SimpleFocusListWalker</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
<span class="linenos">20</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="k">def</span> <span class="nf">item_chosen</span><span class="p">(</span><span class="n">button</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">,</span> <span class="n">choice</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">23</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">([</span><span class="s2">&quot;You chose &quot;</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
<span class="linenos">24</span>    <span class="n">done</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="s2">&quot;Ok&quot;</span><span class="p">)</span>
<span class="linenos">25</span>    <span class="n">urwid</span><span class="o">.</span><span class="n">connect_signal</span><span class="p">(</span><span class="n">done</span><span class="p">,</span> <span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="n">exit_program</span><span class="p">)</span>
<span class="linenos">26</span>    <span class="n">main</span><span class="o">.</span><span class="n">original_widget</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">(</span>
<span class="linenos">27</span>        <span class="n">urwid</span><span class="o">.</span><span class="n">Pile</span><span class="p">(</span>
<span class="linenos">28</span>            <span class="p">[</span>
<span class="linenos">29</span>                <span class="n">response</span><span class="p">,</span>
<span class="linenos">30</span>                <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">done</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">focus_map</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">),</span>
<span class="linenos">31</span>            <span class="p">]</span>
<span class="linenos">32</span>        <span class="p">)</span>
<span class="linenos">33</span>    <span class="p">)</span>
<span class="linenos">34</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="k">def</span> <span class="nf">exit_program</span><span class="p">(</span><span class="n">button</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">37</span>    <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos">38</span>
<span class="linenos">39</span>
<span class="linenos">40</span><span class="n">main</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Padding</span><span class="p">(</span><span class="n">menu</span><span class="p">(</span><span class="s2">&quot;Pythons&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="p">),</span> <span class="n">left</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos">41</span><span class="n">top</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Overlay</span><span class="p">(</span>
<span class="linenos">42</span>    <span class="n">main</span><span class="p">,</span>
<span class="linenos">43</span>    <span class="n">urwid</span><span class="o">.</span><span class="n">SolidFill</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\N{MEDIUM SHADE}</span><span class="s2">&quot;</span><span class="p">),</span>
<span class="linenos">44</span>    <span class="n">align</span><span class="o">=</span><span class="n">urwid</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span>
<span class="linenos">45</span>    <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">RELATIVE</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
<span class="linenos">46</span>    <span class="n">valign</span><span class="o">=</span><span class="n">urwid</span><span class="o">.</span><span class="n">MIDDLE</span><span class="p">,</span>
<span class="linenos">47</span>    <span class="n">height</span><span class="o">=</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">RELATIVE</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span>
<span class="linenos">48</span>    <span class="n">min_width</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="linenos">49</span>    <span class="n">min_height</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
<span class="linenos">50</span><span class="p">)</span>
<span class="linenos">51</span><span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;reversed&quot;</span><span class="p">,</span> <span class="s2">&quot;standout&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>menu()</em> builds a <a class="reference internal" href="../reference/widget.html#urwid.ListBox" title="urwid.ListBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">ListBox</span></code></a> with a <em>title</em> and a sequence of <a class="reference internal" href="../reference/widget.html#urwid.Button" title="urwid.Button"><code class="xref py py-class docutils literal notranslate"><span class="pre">Button</span></code></a>
widgets.  Each button has its <code class="docutils literal notranslate"><span class="pre">'click'</span></code> signal attached to <em>item_chosen</em>,
with item name is passed as data.
The buttons are decorated with an <a class="reference internal" href="../reference/widget.html#urwid.AttrMap" title="urwid.AttrMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrMap</span></code></a> that applies
a display attribute when a button is in focus.</p></li>
<li><p><em>item_chosen()</em> replaces the menu displayed with text indicating the users’
choice.</p></li>
<li><p><em>exit_program()</em> causes the program to exit on any keystroke.</p></li>
<li><p>The menu is created and decorated with an <a class="reference internal" href="../reference/widget.html#urwid.Overlay" title="urwid.Overlay"><code class="xref py py-class docutils literal notranslate"><span class="pre">Overlay</span></code></a> using a
<a class="reference internal" href="../reference/widget.html#urwid.SolidFill" title="urwid.SolidFill"><code class="xref py py-class docutils literal notranslate"><span class="pre">SolidFill</span></code></a> as the background.  The <a class="reference internal" href="../reference/widget.html#urwid.Overlay" title="urwid.Overlay"><code class="xref py py-class docutils literal notranslate"><span class="pre">Overlay</span></code></a> is given a
miniumum width and height but is allowed to expand to 60% of the available
space if the user’s terminal window is large enough.</p></li>
</ul>
</section>
<section id="cascading-menu">
<h2>Cascading Menu<a class="headerlink" href="#cascading-menu" title="Link to this heading">¶</a></h2>
<img alt="../_images/cmenu1.png" src="../_images/cmenu1.png" />
<img alt="../_images/cmenu2.png" src="../_images/cmenu2.png" />
<img alt="../_images/cmenu3.png" src="../_images/cmenu3.png" />
<img alt="../_images/cmenu4.png" src="../_images/cmenu4.png" />
<p>A nested menu effect can be created by having some buttons open new menus.  This program
lets you choose an option from a nested menu that cascades across the screen.  You may
return to previous menus by pressing <em>ESC</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos">  2</span>
<span class="linenos">  3</span><span class="kn">import</span> <span class="nn">typing</span>
<span class="linenos">  4</span>
<span class="linenos">  5</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos">  8</span>    <span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Hashable</span><span class="p">,</span> <span class="n">Iterable</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="k">def</span> <span class="nf">menu_button</span><span class="p">(</span>
<span class="linenos"> 12</span>    <span class="n">caption</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
<span class="linenos"> 13</span>    <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
<span class="linenos"> 14</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">:</span>
<span class="linenos"> 15</span>    <span class="n">button</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">caption</span><span class="p">,</span> <span class="n">on_press</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
<span class="linenos"> 16</span>    <span class="k">return</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">focus_map</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">)</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span>
<span class="linenos"> 19</span><span class="k">def</span> <span class="nf">sub_menu</span><span class="p">(</span>
<span class="linenos"> 20</span>    <span class="n">caption</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
<span class="linenos"> 21</span>    <span class="n">choices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">urwid</span><span class="o">.</span><span class="n">Widget</span><span class="p">],</span>
<span class="linenos"> 22</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Widget</span><span class="p">:</span>
<span class="linenos"> 23</span>    <span class="n">contents</span> <span class="o">=</span> <span class="n">menu</span><span class="p">(</span><span class="n">caption</span><span class="p">,</span> <span class="n">choices</span><span class="p">)</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span>    <span class="k">def</span> <span class="nf">open_menu</span><span class="p">(</span><span class="n">button</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 26</span>        <span class="k">return</span> <span class="n">top</span><span class="o">.</span><span class="n">open_box</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
<span class="linenos"> 27</span>
<span class="linenos"> 28</span>    <span class="k">return</span> <span class="n">menu_button</span><span class="p">([</span><span class="n">caption</span><span class="p">,</span> <span class="s2">&quot;...&quot;</span><span class="p">],</span> <span class="n">open_menu</span><span class="p">)</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span>
<span class="linenos"> 31</span><span class="k">def</span> <span class="nf">menu</span><span class="p">(</span>
<span class="linenos"> 32</span>    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
<span class="linenos"> 33</span>    <span class="n">choices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">urwid</span><span class="o">.</span><span class="n">Widget</span><span class="p">],</span>
<span class="linenos"> 34</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ListBox</span><span class="p">:</span>
<span class="linenos"> 35</span>    <span class="n">body</span> <span class="o">=</span> <span class="p">[</span><span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">title</span><span class="p">),</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Divider</span><span class="p">(),</span> <span class="o">*</span><span class="n">choices</span><span class="p">]</span>
<span class="linenos"> 36</span>    <span class="k">return</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">SimpleFocusListWalker</span><span class="p">(</span><span class="n">body</span><span class="p">))</span>
<span class="linenos"> 37</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span><span class="k">def</span> <span class="nf">item_chosen</span><span class="p">(</span><span class="n">button</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 40</span>    <span class="n">response</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">([</span><span class="s2">&quot;You chose &quot;</span><span class="p">,</span> <span class="n">button</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
<span class="linenos"> 41</span>    <span class="n">done</span> <span class="o">=</span> <span class="n">menu_button</span><span class="p">(</span><span class="s2">&quot;Ok&quot;</span><span class="p">,</span> <span class="n">exit_program</span><span class="p">)</span>
<span class="linenos"> 42</span>    <span class="n">top</span><span class="o">.</span><span class="n">open_box</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Pile</span><span class="p">([</span><span class="n">response</span><span class="p">,</span> <span class="n">done</span><span class="p">])))</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span>
<span class="linenos"> 45</span><span class="k">def</span> <span class="nf">exit_program</span><span class="p">(</span><span class="n">button</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">NoReturn</span><span class="p">:</span>
<span class="linenos"> 46</span>    <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span><span class="n">menu_top</span> <span class="o">=</span> <span class="n">menu</span><span class="p">(</span>
<span class="linenos"> 50</span>    <span class="s2">&quot;Main Menu&quot;</span><span class="p">,</span>
<span class="linenos"> 51</span>    <span class="p">[</span>
<span class="linenos"> 52</span>        <span class="n">sub_menu</span><span class="p">(</span>
<span class="linenos"> 53</span>            <span class="s2">&quot;Applications&quot;</span><span class="p">,</span>
<span class="linenos"> 54</span>            <span class="p">[</span>
<span class="linenos"> 55</span>                <span class="n">sub_menu</span><span class="p">(</span>
<span class="linenos"> 56</span>                    <span class="s2">&quot;Accessories&quot;</span><span class="p">,</span>
<span class="linenos"> 57</span>                    <span class="p">[</span>
<span class="linenos"> 58</span>                        <span class="n">menu_button</span><span class="p">(</span><span class="s2">&quot;Text Editor&quot;</span><span class="p">,</span> <span class="n">item_chosen</span><span class="p">),</span>
<span class="linenos"> 59</span>                        <span class="n">menu_button</span><span class="p">(</span><span class="s2">&quot;Terminal&quot;</span><span class="p">,</span> <span class="n">item_chosen</span><span class="p">),</span>
<span class="linenos"> 60</span>                    <span class="p">],</span>
<span class="linenos"> 61</span>                <span class="p">),</span>
<span class="linenos"> 62</span>            <span class="p">],</span>
<span class="linenos"> 63</span>        <span class="p">),</span>
<span class="linenos"> 64</span>        <span class="n">sub_menu</span><span class="p">(</span>
<span class="linenos"> 65</span>            <span class="s2">&quot;System&quot;</span><span class="p">,</span>
<span class="linenos"> 66</span>            <span class="p">[</span>
<span class="linenos"> 67</span>                <span class="n">sub_menu</span><span class="p">(</span>
<span class="linenos"> 68</span>                    <span class="s2">&quot;Preferences&quot;</span><span class="p">,</span>
<span class="linenos"> 69</span>                    <span class="p">[</span><span class="n">menu_button</span><span class="p">(</span><span class="s2">&quot;Appearance&quot;</span><span class="p">,</span> <span class="n">item_chosen</span><span class="p">)],</span>
<span class="linenos"> 70</span>                <span class="p">),</span>
<span class="linenos"> 71</span>                <span class="n">menu_button</span><span class="p">(</span><span class="s2">&quot;Lock Screen&quot;</span><span class="p">,</span> <span class="n">item_chosen</span><span class="p">),</span>
<span class="linenos"> 72</span>            <span class="p">],</span>
<span class="linenos"> 73</span>        <span class="p">),</span>
<span class="linenos"> 74</span>    <span class="p">],</span>
<span class="linenos"> 75</span><span class="p">)</span>
<span class="linenos"> 76</span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span><span class="k">class</span> <span class="nc">CascadingBoxes</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">WidgetPlaceholder</span><span class="p">):</span>
<span class="linenos"> 79</span>    <span class="n">max_box_levels</span> <span class="o">=</span> <span class="mi">4</span>
<span class="linenos"> 80</span>
<span class="linenos"> 81</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Widget</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 82</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">SolidFill</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))</span>
<span class="linenos"> 83</span>        <span class="bp">self</span><span class="o">.</span><span class="n">box_level</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos"> 84</span>        <span class="bp">self</span><span class="o">.</span><span class="n">open_box</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
<span class="linenos"> 85</span>
<span class="linenos"> 86</span>    <span class="k">def</span> <span class="nf">open_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Widget</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 87</span>        <span class="bp">self</span><span class="o">.</span><span class="n">original_widget</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Overlay</span><span class="p">(</span>
<span class="linenos"> 88</span>            <span class="n">urwid</span><span class="o">.</span><span class="n">LineBox</span><span class="p">(</span><span class="n">box</span><span class="p">),</span>
<span class="linenos"> 89</span>            <span class="bp">self</span><span class="o">.</span><span class="n">original_widget</span><span class="p">,</span>
<span class="linenos"> 90</span>            <span class="n">align</span><span class="o">=</span><span class="n">urwid</span><span class="o">.</span><span class="n">CENTER</span><span class="p">,</span>
<span class="linenos"> 91</span>            <span class="n">width</span><span class="o">=</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">RELATIVE</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
<span class="linenos"> 92</span>            <span class="n">valign</span><span class="o">=</span><span class="n">urwid</span><span class="o">.</span><span class="n">MIDDLE</span><span class="p">,</span>
<span class="linenos"> 93</span>            <span class="n">height</span><span class="o">=</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">RELATIVE</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span>
<span class="linenos"> 94</span>            <span class="n">min_width</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
<span class="linenos"> 95</span>            <span class="n">min_height</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
<span class="linenos"> 96</span>            <span class="n">left</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">box_level</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos"> 97</span>            <span class="n">right</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_box_levels</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">box_level</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
<span class="linenos"> 98</span>            <span class="n">top</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">box_level</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 99</span>            <span class="n">bottom</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_box_levels</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">box_level</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="linenos">100</span>        <span class="p">)</span>
<span class="linenos">101</span>        <span class="bp">self</span><span class="o">.</span><span class="n">box_level</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">102</span>
<span class="linenos">103</span>    <span class="k">def</span> <span class="nf">keypress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">104</span>        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;esc&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">box_level</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">105</span>            <span class="bp">self</span><span class="o">.</span><span class="n">original_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">original_widget</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">106</span>            <span class="bp">self</span><span class="o">.</span><span class="n">box_level</span> <span class="o">-=</span> <span class="mi">1</span>
<span class="linenos">107</span>            <span class="k">return</span> <span class="kc">None</span>
<span class="linenos">108</span>
<span class="linenos">109</span>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">keypress</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
<span class="linenos">110</span>
<span class="linenos">111</span>
<span class="linenos">112</span><span class="n">top</span> <span class="o">=</span> <span class="n">CascadingBoxes</span><span class="p">(</span><span class="n">menu_top</span><span class="p">)</span>
<span class="linenos">113</span><span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;reversed&quot;</span><span class="p">,</span> <span class="s2">&quot;standout&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>menu_button()</em> returns an <a class="reference internal" href="../reference/widget.html#urwid.AttrMap" title="urwid.AttrMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrMap</span></code></a>-decorated <a class="reference internal" href="../reference/widget.html#urwid.Button" title="urwid.Button"><code class="xref py py-class docutils literal notranslate"><span class="pre">Button</span></code></a>
and attaches a <em>callback</em> to its <code class="docutils literal notranslate"><span class="pre">'click'</span></code> signal.  This function is
used for both sub-menus and final selection buttons.</p></li>
<li><p><em>sub_menu()</em> creates a menu button and a closure that will open the
menu when that button is clicked.  Notice that
<a class="reference internal" href="../manual/displayattributes.html#text-markup"><span class="std std-ref">text markup</span></a> is used to add <code class="docutils literal notranslate"><span class="pre">'...'</span></code> to the end of
the <em>caption</em> passed to <em>menu_button()</em>.</p></li>
<li><p><em>menu()</em> builds a <a class="reference internal" href="../reference/widget.html#urwid.ListBox" title="urwid.ListBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">ListBox</span></code></a> with a <em>title</em> and a sequence of widgets.</p></li>
<li><p><em>item_chosen()</em> displays the users’ choice similar to the previous example.</p></li>
<li><p><em>menu_top</em> is the top level menu with all of its child menus and
options built using the functions above.</p></li>
</ul>
<p>This example introduces <a class="reference internal" href="../reference/widget.html#urwid.WidgetPlaceholder" title="urwid.WidgetPlaceholder"><code class="xref py py-class docutils literal notranslate"><span class="pre">WidgetPlaceholder</span></code></a>. <a class="reference internal" href="../reference/widget.html#urwid.WidgetPlaceholder" title="urwid.WidgetPlaceholder"><code class="xref py py-class docutils literal notranslate"><span class="pre">WidgetPlaceholder</span></code></a> is a
<a class="reference internal" href="../manual/widgets.html#decoration-widgets"><span class="std std-ref">decoration widget</span></a> that does nothing to the widget it
decorates.  It is useful if you need a simple way to replace a widget that doesn’t
involve knowing its position in a <a class="reference internal" href="../manual/widgets.html#container-widgets"><span class="std std-ref">container</span></a>, or in this
case as a base class for a widget that will be replacing its own contents regularly.</p>
<ul class="simple">
<li><p><em>CascadingBoxes</em> is a new widget that extends <a class="reference internal" href="../reference/widget.html#urwid.WidgetPlaceholder" title="urwid.WidgetPlaceholder"><code class="xref py py-class docutils literal notranslate"><span class="pre">WidgetPlaceholder</span></code></a>.
It provides an <em>open_box()</em> method that displays a box widget <em>box</em> “on top of”
all the previous content with an <a class="reference internal" href="../reference/widget.html#urwid.Overlay" title="urwid.Overlay"><code class="xref py py-class docutils literal notranslate"><span class="pre">Overlay</span></code></a> and a <a class="reference internal" href="../reference/widget.html#urwid.LineBox" title="urwid.LineBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">LineBox</span></code></a>.
The position of each successive box is shifted right and down from the
previous one.</p></li>
<li><p><em>CascadingBoxes.keypress()</em> intercepts <em>ESC</em> keys to cause the current box
to be removed and the previous one to be shown.  This allows the user to
return to a previous menu level.</p></li>
</ul>
</section>
<section id="horizontal-menu">
<h2>Horizontal Menu<a class="headerlink" href="#horizontal-menu" title="Link to this heading">¶</a></h2>
<img alt="../_images/hmenu1.png" src="../_images/hmenu1.png" />
<img alt="../_images/hmenu2.png" src="../_images/hmenu2.png" />
<img alt="../_images/hmenu3.png" src="../_images/hmenu3.png" />
<img alt="../_images/hmenu4.png" src="../_images/hmenu4.png" />
<p>This example is like the previous but new menus appear on the right and push
old menus off the left side of the screen.
The look of buttons and other menu elements are heavily customized
and new widget classes are used instead of factory functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos">  2</span>
<span class="linenos">  3</span><span class="kn">import</span> <span class="nn">typing</span>
<span class="linenos">  4</span>
<span class="linenos">  5</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos">  8</span>    <span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Hashable</span><span class="p">,</span> <span class="n">Iterable</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="k">class</span> <span class="nc">MenuButton</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="linenos"> 12</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<span class="linenos"> 13</span>        <span class="bp">self</span><span class="p">,</span>
<span class="linenos"> 14</span>        <span class="n">caption</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
<span class="linenos"> 15</span>        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">MenuButton</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
<span class="linenos"> 16</span>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 17</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">on_press</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
<span class="linenos"> 18</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span>
<span class="linenos"> 19</span>            <span class="n">urwid</span><span class="o">.</span><span class="n">SelectableIcon</span><span class="p">([</span><span class="s2">&quot;  </span><span class="se">\N{BULLET}</span><span class="s2"> &quot;</span><span class="p">,</span> <span class="n">caption</span><span class="p">],</span> <span class="mi">2</span><span class="p">),</span>
<span class="linenos"> 20</span>            <span class="kc">None</span><span class="p">,</span>
<span class="linenos"> 21</span>            <span class="s2">&quot;selected&quot;</span><span class="p">,</span>
<span class="linenos"> 22</span>        <span class="p">)</span>
<span class="linenos"> 23</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="k">class</span> <span class="nc">SubMenu</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">WidgetWrap</span><span class="p">[</span><span class="n">MenuButton</span><span class="p">]):</span>
<span class="linenos"> 26</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<span class="linenos"> 27</span>        <span class="bp">self</span><span class="p">,</span>
<span class="linenos"> 28</span>        <span class="n">caption</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
<span class="linenos"> 29</span>        <span class="n">choices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">urwid</span><span class="o">.</span><span class="n">Widget</span><span class="p">],</span>
<span class="linenos"> 30</span>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 31</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">MenuButton</span><span class="p">([</span><span class="n">caption</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\N{HORIZONTAL ELLIPSIS}</span><span class="s2">&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_menu</span><span class="p">))</span>
<span class="linenos"> 32</span>        <span class="n">line</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Divider</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\N{LOWER ONE QUARTER BLOCK}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos"> 33</span>        <span class="n">listbox</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span>
<span class="linenos"> 34</span>            <span class="n">urwid</span><span class="o">.</span><span class="n">SimpleFocusListWalker</span><span class="p">(</span>
<span class="linenos"> 35</span>                <span class="p">[</span>
<span class="linenos"> 36</span>                    <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">([</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  &quot;</span><span class="p">,</span> <span class="n">caption</span><span class="p">]),</span> <span class="s2">&quot;heading&quot;</span><span class="p">),</span>
<span class="linenos"> 37</span>                    <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">),</span>
<span class="linenos"> 38</span>                    <span class="n">urwid</span><span class="o">.</span><span class="n">Divider</span><span class="p">(),</span>
<span class="linenos"> 39</span>                    <span class="o">*</span><span class="n">choices</span><span class="p">,</span>
<span class="linenos"> 40</span>                    <span class="n">urwid</span><span class="o">.</span><span class="n">Divider</span><span class="p">(),</span>
<span class="linenos"> 41</span>                <span class="p">]</span>
<span class="linenos"> 42</span>            <span class="p">)</span>
<span class="linenos"> 43</span>        <span class="p">)</span>
<span class="linenos"> 44</span>        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">listbox</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">)</span>
<span class="linenos"> 45</span>
<span class="linenos"> 46</span>    <span class="k">def</span> <span class="nf">open_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">MenuButton</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 47</span>        <span class="n">top</span><span class="o">.</span><span class="n">open_box</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="p">)</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span>
<span class="linenos"> 50</span><span class="k">class</span> <span class="nc">Choice</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">WidgetWrap</span><span class="p">[</span><span class="n">MenuButton</span><span class="p">]):</span>
<span class="linenos"> 51</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<span class="linenos"> 52</span>        <span class="bp">self</span><span class="p">,</span>
<span class="linenos"> 53</span>        <span class="n">caption</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
<span class="linenos"> 54</span>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 55</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">MenuButton</span><span class="p">(</span><span class="n">caption</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">item_chosen</span><span class="p">))</span>
<span class="linenos"> 56</span>        <span class="bp">self</span><span class="o">.</span><span class="n">caption</span> <span class="o">=</span> <span class="n">caption</span>
<span class="linenos"> 57</span>
<span class="linenos"> 58</span>    <span class="k">def</span> <span class="nf">item_chosen</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">MenuButton</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 59</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">([</span><span class="s2">&quot;  You chose &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">caption</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
<span class="linenos"> 60</span>        <span class="n">done</span> <span class="o">=</span> <span class="n">MenuButton</span><span class="p">(</span><span class="s2">&quot;Ok&quot;</span><span class="p">,</span> <span class="n">exit_program</span><span class="p">)</span>
<span class="linenos"> 61</span>        <span class="n">response_box</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Pile</span><span class="p">([</span><span class="n">response</span><span class="p">,</span> <span class="n">done</span><span class="p">]))</span>
<span class="linenos"> 62</span>        <span class="n">top</span><span class="o">.</span><span class="n">open_box</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">response_box</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">))</span>
<span class="linenos"> 63</span>
<span class="linenos"> 64</span>
<span class="linenos"> 65</span><span class="k">def</span> <span class="nf">exit_program</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="linenos"> 66</span>    <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos"> 67</span>
<span class="linenos"> 68</span>
<span class="linenos"> 69</span><span class="n">menu_top</span> <span class="o">=</span> <span class="n">SubMenu</span><span class="p">(</span>
<span class="linenos"> 70</span>    <span class="s2">&quot;Main Menu&quot;</span><span class="p">,</span>
<span class="linenos"> 71</span>    <span class="p">[</span>
<span class="linenos"> 72</span>        <span class="n">SubMenu</span><span class="p">(</span>
<span class="linenos"> 73</span>            <span class="s2">&quot;Applications&quot;</span><span class="p">,</span>
<span class="linenos"> 74</span>            <span class="p">[</span>
<span class="linenos"> 75</span>                <span class="n">SubMenu</span><span class="p">(</span>
<span class="linenos"> 76</span>                    <span class="s2">&quot;Accessories&quot;</span><span class="p">,</span>
<span class="linenos"> 77</span>                    <span class="p">[</span>
<span class="linenos"> 78</span>                        <span class="n">Choice</span><span class="p">(</span><span class="s2">&quot;Text Editor&quot;</span><span class="p">),</span>
<span class="linenos"> 79</span>                        <span class="n">Choice</span><span class="p">(</span><span class="s2">&quot;Terminal&quot;</span><span class="p">),</span>
<span class="linenos"> 80</span>                    <span class="p">],</span>
<span class="linenos"> 81</span>                <span class="p">)</span>
<span class="linenos"> 82</span>            <span class="p">],</span>
<span class="linenos"> 83</span>        <span class="p">),</span>
<span class="linenos"> 84</span>        <span class="n">SubMenu</span><span class="p">(</span>
<span class="linenos"> 85</span>            <span class="s2">&quot;System&quot;</span><span class="p">,</span>
<span class="linenos"> 86</span>            <span class="p">[</span>
<span class="linenos"> 87</span>                <span class="n">SubMenu</span><span class="p">(</span><span class="s2">&quot;Preferences&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Choice</span><span class="p">(</span><span class="s2">&quot;Appearance&quot;</span><span class="p">)]),</span>
<span class="linenos"> 88</span>                <span class="n">Choice</span><span class="p">(</span><span class="s2">&quot;Lock Screen&quot;</span><span class="p">),</span>
<span class="linenos"> 89</span>            <span class="p">],</span>
<span class="linenos"> 90</span>        <span class="p">),</span>
<span class="linenos"> 91</span>    <span class="p">],</span>
<span class="linenos"> 92</span><span class="p">)</span>
<span class="linenos"> 93</span>
<span class="linenos"> 94</span><span class="n">palette</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos"> 95</span>    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;light gray&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">),</span>
<span class="linenos"> 96</span>    <span class="p">(</span><span class="s2">&quot;heading&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;light gray&quot;</span><span class="p">),</span>
<span class="linenos"> 97</span>    <span class="p">(</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;light gray&quot;</span><span class="p">),</span>
<span class="linenos"> 98</span>    <span class="p">(</span><span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="s2">&quot;dark gray&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">),</span>
<span class="linenos"> 99</span>    <span class="p">(</span><span class="s2">&quot;focus heading&quot;</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;dark red&quot;</span><span class="p">),</span>
<span class="linenos">100</span>    <span class="p">(</span><span class="s2">&quot;focus line&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;dark red&quot;</span><span class="p">),</span>
<span class="linenos">101</span>    <span class="p">(</span><span class="s2">&quot;focus options&quot;</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;light gray&quot;</span><span class="p">),</span>
<span class="linenos">102</span>    <span class="p">(</span><span class="s2">&quot;selected&quot;</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="s2">&quot;dark blue&quot;</span><span class="p">),</span>
<span class="linenos">103</span><span class="p">]</span>
<span class="linenos">104</span><span class="n">focus_map</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;heading&quot;</span><span class="p">:</span> <span class="s2">&quot;focus heading&quot;</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="s2">&quot;focus options&quot;</span><span class="p">,</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span> <span class="s2">&quot;focus line&quot;</span><span class="p">}</span>
<span class="linenos">105</span>
<span class="linenos">106</span>
<span class="linenos">107</span><span class="k">class</span> <span class="nc">HorizontalBoxes</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Columns</span><span class="p">):</span>
<span class="linenos">108</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">109</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([],</span> <span class="n">dividechars</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">110</span>
<span class="linenos">111</span>    <span class="k">def</span> <span class="nf">open_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">:</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Widget</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">112</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">:</span>
<span class="linenos">113</span>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">focus_position</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
<span class="linenos">114</span>        <span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
<span class="linenos">115</span>            <span class="p">(</span>
<span class="linenos">116</span>                <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">,</span> <span class="n">focus_map</span><span class="p">),</span>
<span class="linenos">117</span>                <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">GIVEN</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span>
<span class="linenos">118</span>            <span class="p">)</span>
<span class="linenos">119</span>        <span class="p">)</span>
<span class="linenos">120</span>        <span class="bp">self</span><span class="o">.</span><span class="n">focus_position</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="linenos">121</span>
<span class="linenos">122</span>
<span class="linenos">123</span><span class="n">top</span> <span class="o">=</span> <span class="n">HorizontalBoxes</span><span class="p">()</span>
<span class="linenos">124</span><span class="n">top</span><span class="o">.</span><span class="n">open_box</span><span class="p">(</span><span class="n">menu_top</span><span class="o">.</span><span class="n">menu</span><span class="p">)</span>
<span class="linenos">125</span><span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Filler</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">palette</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p><em>MenuButton</em> is a customized <a class="reference internal" href="../reference/widget.html#urwid.Button" title="urwid.Button"><code class="xref py py-class docutils literal notranslate"><span class="pre">Button</span></code></a> widget.  <a class="reference internal" href="../reference/widget.html#urwid.Button" title="urwid.Button"><code class="xref py py-class docutils literal notranslate"><span class="pre">Button</span></code></a> uses
<a class="reference internal" href="../reference/widget.html#urwid.WidgetWrap" title="urwid.WidgetWrap"><code class="xref py py-class docutils literal notranslate"><span class="pre">WidgetWrap</span></code></a> to create its appearance and this class replaces the
display widget created by <a class="reference internal" href="../reference/widget.html#urwid.Button" title="urwid.Button"><code class="xref py py-class docutils literal notranslate"><span class="pre">Button</span></code></a> by the wrapped widget in
<em>self._w</em>.</p></li>
<li><p><em>SubMenu</em> is implemented with a <em>MenuButton</em> but uses <a class="reference internal" href="../reference/widget.html#urwid.WidgetWrap" title="urwid.WidgetWrap"><code class="xref py py-class docutils literal notranslate"><span class="pre">WidgetWrap</span></code></a>
to hide the implementation instead of inheriting from <em>MenuButton</em>.
The constructor builds a widget for the menu that this button will open
and stores it in <em>self.menu</em>.</p></li>
<li><p><em>Choice</em> is like <em>SubMenu</em> but displays the item chosen instead of
another menu.</p></li>
</ul>
<p>The <em>palette</em> used in this example includes an entry with the special name
<code class="docutils literal notranslate"><span class="pre">None</span></code>.  The foreground and background specified in this entry are used
as a default when no other display attribute is specified.</p>
<ul class="simple">
<li><p><em>HorizontalBoxes</em> arranges the menus displayed similar to the previous
example.  There is no special handling required for going to previous
menus here because <a class="reference internal" href="../reference/widget.html#urwid.Columns" title="urwid.Columns"><code class="xref py py-class docutils literal notranslate"><span class="pre">Columns</span></code></a> already handles switching focus
when <em>LEFT</em> or <em>RIGHT</em> is pressed.  <a class="reference internal" href="../reference/widget.html#urwid.AttrMap" title="urwid.AttrMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttrMap</span></code></a> with the <em>focus_map</em>
dict is used to change the appearance of a number of the display attributes
when a menu is in focus.</p></li>
</ul>
</section>
<section id="adventure-game">
<h2>Adventure Game<a class="headerlink" href="#adventure-game" title="Link to this heading">¶</a></h2>
<img alt="../_images/adventure1.png" src="../_images/adventure1.png" />
<img alt="../_images/adventure2.png" src="../_images/adventure2.png" />
<img alt="../_images/adventure3.png" src="../_images/adventure3.png" />
<img alt="../_images/adventure4.png" src="../_images/adventure4.png" />
<p>We can use the same sort of code to build a simple adventure game.  Instead
of menus we have “places” and instead of submenus and parent menus we just
have “exits”.  This example scrolls previous places off the top of the
screen, allowing you to scroll back to view but not interact with previous
places.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="linenos">  2</span>
<span class="linenos">  3</span><span class="kn">import</span> <span class="nn">typing</span>
<span class="linenos">  4</span>
<span class="linenos">  5</span><span class="kn">import</span> <span class="nn">urwid</span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="k">if</span> <span class="n">typing</span><span class="o">.</span><span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos">  8</span>    <span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Hashable</span><span class="p">,</span> <span class="n">MutableSequence</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="k">class</span> <span class="nc">ActionButton</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
<span class="linenos"> 12</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
<span class="linenos"> 13</span>        <span class="bp">self</span><span class="p">,</span>
<span class="linenos"> 14</span>        <span class="n">caption</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Hashable</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span>
<span class="linenos"> 15</span>        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">ActionButton</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">],</span>
<span class="linenos"> 16</span>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 17</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">on_press</span><span class="o">=</span><span class="n">callback</span><span class="p">)</span>
<span class="linenos"> 18</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">AttrMap</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">SelectableIcon</span><span class="p">(</span><span class="n">caption</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">focus_map</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">)</span>
<span class="linenos"> 19</span>
<span class="linenos"> 20</span>
<span class="linenos"> 21</span><span class="k">class</span> <span class="nc">Place</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">WidgetWrap</span><span class="p">[</span><span class="n">ActionButton</span><span class="p">]):</span>
<span class="linenos"> 22</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">choices</span><span class="p">:</span> <span class="n">MutableSequence</span><span class="p">[</span><span class="n">urwid</span><span class="o">.</span><span class="n">Widget</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 23</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ActionButton</span><span class="p">([</span><span class="s2">&quot; &gt; go to &quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">enter_place</span><span class="p">))</span>
<span class="linenos"> 24</span>        <span class="bp">self</span><span class="o">.</span><span class="n">heading</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">([</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Location: &quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
<span class="linenos"> 25</span>        <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="n">choices</span>
<span class="linenos"> 26</span>        <span class="c1"># create links back to ourself</span>
<span class="linenos"> 27</span>        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
<span class="linenos"> 28</span>            <span class="nb">getattr</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="s2">&quot;choices&quot;</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
<span class="linenos"> 29</span>
<span class="linenos"> 30</span>    <span class="k">def</span> <span class="nf">enter_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">ActionButton</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 31</span>        <span class="n">game</span><span class="o">.</span><span class="n">update_place</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span>
<span class="linenos"> 34</span><span class="k">class</span> <span class="nc">Thing</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">WidgetWrap</span><span class="p">[</span><span class="n">ActionButton</span><span class="p">]):</span>
<span class="linenos"> 35</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 36</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ActionButton</span><span class="p">([</span><span class="s2">&quot; * take &quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">take_thing</span><span class="p">))</span>
<span class="linenos"> 37</span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span>    <span class="k">def</span> <span class="nf">take_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">:</span> <span class="n">ActionButton</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 40</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_w</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> (taken)&quot;</span><span class="p">)</span>
<span class="linenos"> 41</span>        <span class="n">game</span><span class="o">.</span><span class="n">take_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span>
<span class="linenos"> 44</span><span class="k">def</span> <span class="nf">exit_program</span><span class="p">(</span><span class="n">button</span><span class="p">:</span> <span class="n">ActionButton</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">NoReturn</span><span class="p">:</span>
<span class="linenos"> 45</span>    <span class="k">raise</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ExitMainLoop</span><span class="p">()</span>
<span class="linenos"> 46</span>
<span class="linenos"> 47</span>
<span class="linenos"> 48</span><span class="n">map_top</span> <span class="o">=</span> <span class="n">Place</span><span class="p">(</span>
<span class="linenos"> 49</span>    <span class="s2">&quot;porch&quot;</span><span class="p">,</span>
<span class="linenos"> 50</span>    <span class="p">[</span>
<span class="linenos"> 51</span>        <span class="n">Place</span><span class="p">(</span>
<span class="linenos"> 52</span>            <span class="s2">&quot;kitchen&quot;</span><span class="p">,</span>
<span class="linenos"> 53</span>            <span class="p">[</span>
<span class="linenos"> 54</span>                <span class="n">Place</span><span class="p">(</span><span class="s2">&quot;refrigerator&quot;</span><span class="p">,</span> <span class="p">[]),</span>
<span class="linenos"> 55</span>                <span class="n">Place</span><span class="p">(</span><span class="s2">&quot;cupboard&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Thing</span><span class="p">(</span><span class="s2">&quot;jug&quot;</span><span class="p">)]),</span>
<span class="linenos"> 56</span>            <span class="p">],</span>
<span class="linenos"> 57</span>        <span class="p">),</span>
<span class="linenos"> 58</span>        <span class="n">Place</span><span class="p">(</span>
<span class="linenos"> 59</span>            <span class="s2">&quot;garden&quot;</span><span class="p">,</span>
<span class="linenos"> 60</span>            <span class="p">[</span>
<span class="linenos"> 61</span>                <span class="n">Place</span><span class="p">(</span>
<span class="linenos"> 62</span>                    <span class="s2">&quot;tree&quot;</span><span class="p">,</span>
<span class="linenos"> 63</span>                    <span class="p">[</span>
<span class="linenos"> 64</span>                        <span class="n">Thing</span><span class="p">(</span><span class="s2">&quot;lemon&quot;</span><span class="p">),</span>
<span class="linenos"> 65</span>                        <span class="n">Thing</span><span class="p">(</span><span class="s2">&quot;bird&quot;</span><span class="p">),</span>
<span class="linenos"> 66</span>                    <span class="p">],</span>
<span class="linenos"> 67</span>                <span class="p">),</span>
<span class="linenos"> 68</span>            <span class="p">],</span>
<span class="linenos"> 69</span>        <span class="p">),</span>
<span class="linenos"> 70</span>        <span class="n">Place</span><span class="p">(</span>
<span class="linenos"> 71</span>            <span class="s2">&quot;street&quot;</span><span class="p">,</span>
<span class="linenos"> 72</span>            <span class="p">[</span>
<span class="linenos"> 73</span>                <span class="n">Place</span><span class="p">(</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">Thing</span><span class="p">(</span><span class="s2">&quot;sugar&quot;</span><span class="p">)]),</span>
<span class="linenos"> 74</span>                <span class="n">Place</span><span class="p">(</span>
<span class="linenos"> 75</span>                    <span class="s2">&quot;lake&quot;</span><span class="p">,</span>
<span class="linenos"> 76</span>                    <span class="p">[</span><span class="n">Place</span><span class="p">(</span><span class="s2">&quot;beach&quot;</span><span class="p">,</span> <span class="p">[])],</span>
<span class="linenos"> 77</span>                <span class="p">),</span>
<span class="linenos"> 78</span>            <span class="p">],</span>
<span class="linenos"> 79</span>        <span class="p">),</span>
<span class="linenos"> 80</span>    <span class="p">],</span>
<span class="linenos"> 81</span><span class="p">)</span>
<span class="linenos"> 82</span>
<span class="linenos"> 83</span>
<span class="linenos"> 84</span><span class="k">class</span> <span class="nc">AdventureGame</span><span class="p">:</span>
<span class="linenos"> 85</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 86</span>        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">SimpleFocusListWalker</span><span class="p">([])</span>
<span class="linenos"> 87</span>        <span class="bp">self</span><span class="o">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">ListBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
<span class="linenos"> 88</span>        <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="linenos"> 89</span>        <span class="bp">self</span><span class="o">.</span><span class="n">update_place</span><span class="p">(</span><span class="n">map_top</span><span class="p">)</span>
<span class="linenos"> 90</span>
<span class="linenos"> 91</span>    <span class="k">def</span> <span class="nf">update_place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">place</span><span class="p">:</span> <span class="n">Place</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 92</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>  <span class="c1"># disable interaction with previous place</span>
<span class="linenos"> 93</span>            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">WidgetDisable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="linenos"> 94</span>        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">urwid</span><span class="o">.</span><span class="n">Pile</span><span class="p">([</span><span class="n">place</span><span class="o">.</span><span class="n">heading</span><span class="p">,</span> <span class="o">*</span><span class="n">place</span><span class="o">.</span><span class="n">choices</span><span class="p">]))</span>
<span class="linenos"> 95</span>        <span class="bp">self</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">focus_position</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="linenos"> 96</span>        <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>
<span class="linenos"> 97</span>
<span class="linenos"> 98</span>    <span class="k">def</span> <span class="nf">take_thing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thing</span><span class="p">:</span> <span class="n">Thing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 99</span>        <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">thing</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="linenos">100</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span> <span class="o">&gt;=</span> <span class="p">{</span><span class="s2">&quot;sugar&quot;</span><span class="p">,</span> <span class="s2">&quot;lemon&quot;</span><span class="p">,</span> <span class="s2">&quot;jug&quot;</span><span class="p">}:</span>
<span class="linenos">101</span>            <span class="n">response</span> <span class="o">=</span> <span class="n">urwid</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s2">&quot;You can make lemonade!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">102</span>            <span class="n">done</span> <span class="o">=</span> <span class="n">ActionButton</span><span class="p">(</span><span class="s2">&quot; - Joy&quot;</span><span class="p">,</span> <span class="n">exit_program</span><span class="p">)</span>
<span class="linenos">103</span>            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">response</span><span class="p">,</span> <span class="n">done</span><span class="p">]</span>
<span class="linenos">104</span>        <span class="k">else</span><span class="p">:</span>
<span class="linenos">105</span>            <span class="bp">self</span><span class="o">.</span><span class="n">update_place</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">place</span><span class="p">)</span>
<span class="linenos">106</span>
<span class="linenos">107</span>
<span class="linenos">108</span><span class="n">game</span> <span class="o">=</span> <span class="n">AdventureGame</span><span class="p">()</span>
<span class="linenos">109</span><span class="n">urwid</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">(</span><span class="n">game</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;reversed&quot;</span><span class="p">,</span> <span class="s2">&quot;standout&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>This example starts to show some separation between the application logic
and the widgets that have been created.  The <em>AdventureGame</em> class is
responsible for all the changes that happen through the game and manages
the topmost widget, but isn’t a widget itself.  This is a good pattern to
follow as your application grows larger.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/urwid-logo.png" alt="Logo"/>
            </a></p><h3>Table of contents</h3>
  <ul>
<li><a class="reference internal" href="#">Urwid Tutorial</a><ul>
<li><a class="reference internal" href="#minimal-application">Minimal Application</a></li>
<li><a class="reference internal" href="#global-input">Global Input</a></li>
<li><a class="reference internal" href="#display-attributes">Display Attributes</a></li>
<li><a class="reference internal" href="#high-color-modes">High Color Modes</a></li>
<li><a class="reference internal" href="#question-and-answer">Question and Answer</a></li>
<li><a class="reference internal" href="#signal-handlers">Signal Handlers</a></li>
<li><a class="reference internal" href="#multiple-questions">Multiple Questions</a></li>
<li><a class="reference internal" href="#simple-menu">Simple Menu</a></li>
<li><a class="reference internal" href="#cascading-menu">Cascading Menu</a></li>
<li><a class="reference internal" href="#horizontal-menu">Horizontal Menu</a></li>
<li><a class="reference internal" href="#adventure-game">Adventure Game</a></li>
</ul>
</li>
</ul>


  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../examples/index.html"
                          title="previous chapter">Example Programs</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../manual/index.html"
                          title="next chapter">Urwid Manual</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorial/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../manual/index.html" title="Urwid Manual"
             >next</a> |</li>
        <li class="right" >
          <a href="../examples/index.html" title="Example Programs"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Urwid 2.6.10</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Urwid Tutorial</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2014, Ian Ward et al.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>